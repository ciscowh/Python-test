import re
str1 = 'TCP server 172.16.1.101:443 localserver 172.16.66.1:53710, idle 0:01:09, bytes 27575949, flags UIO'
re_result = re.findall('\w+',str1)
re_result_protocol = re.findall ('T\w+',str1)
re_result_ip = re.findall('\d{1,3}\.\d{1,3}.\d{1,3}.\d{1,3}',str1)
re_result_time = re.findall('\d{1,2}:\d{1,2}:\d{1,2}',str1)
re_result_bytes = re.findall('[1-9][1-9][1-9][1-9][1-9][1-9][1-9][1-9]',str1)
re_result_flags = re.findall('U\w+',str1)
line1 = '{:<15}: {:<10}' .format('protocol',re_result_protocol[0])
line2 = '{:<15}: {:<10}:{:<5}' .format('server',re_result_ip[0],re_result[6])
line3 = '{:<15}: {:<10}:{:<5}' .format('localserver',re_result_ip[1],re_result[12])
line4 = '{:<15}: {:<2}小时{:>3}分钟{:>3}秒' .format('idle',re_result[14],re_result[15],re_result[16])
line5 = '{:<15}: {:<10}' .format('bytes',re_result_bytes[0])
line6 = '{:<15}: {:<10}' .format('flags',re_result_flags[0])
print(line1)
print(line2)
print(line3)
print(line4)
print(line5)
print(line6)
